<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>streetmuseum</title>
    <script src="js/jquery-2.1.3.min.js"></script>
    <link rel="stylesheet" href="css/sample.css">
</head>



<body>
    

    <header>

    </header>

    <main>


        <!-- MAP[START] -->
    <h1>STREET MUSEUM</h1>
    <h2>ユーザー画面</h2>

    <div id="myMap" style='width:100%;height:450px;'></div>
        <!-- MAP[END] -->
   
        

   
        <p >MET Fine arts club</p>

    <div id="main">

      

    </div>

 
    </main>



    <footer></footer>






     <!-- // [ MapTypeId ] https://msdn.microsoft.com/en-us/library/mt712700.aspx -->
     <script src='https://www.bing.com/api/maps/mapcontrol?callback=GetMap&key=' async defer></script>
     <!-- //Initialization processing -->


    <!-- ここから先はFIREBASEの設定 ----------------------------------------------------->

     <script src="https://www.gstatic.com/firebasejs/6.6.1/firebase.js"></script>



     <script>
     // firebaseの設定-------------------------------------------
     // Your web app's Firebase configuration
     var firebaseConfig = {
       apiKey: "",
       authDomain: "street-museum-25905.firebaseapp.com",
       databaseURL: "https://street-museum-25905-default-rtdb.firebaseio.com/",
       projectId: "street-museum-25905",
       storageBucket: "street-museum-25905.appspot.com",
       messagingSenderId: "315133392979",
       appId: "1:315133392979:web:878469ebb4474167a2aea6"
     };
     // Initialize Firebase
     firebase.initializeApp(firebaseConfig);
 


     //firebaseのデーターベース（保存させる場所）を使いますよ
     const newPostRef = firebase.database().ref();

 
     newPostRef.on("child_added", function (data) {
 
     let v =data.val();

     GetMap(
    //  一つ目のピンの作品情報
     v.foruser4[0],
     v.foruser5[0],
     v.foruser1[0],
     v.foruser2[0],
     v.foruser3[0],
    // 二つ目のピンの作品情報
     v.foruser4[1],
     v.foruser5[1],
     v.foruser1[1],
     v.foruser2[1],
     v.foruser3[1],
    // 三つめのピンの作品情報
     v.foruser4[2],
     v.foruser5[2],
     v.foruser1[2],
     v.foruser2[2],
     v.foruser3[2],
    // 四つ目のピンの作品情報
     v.foruser4[3],
     v.foruser5[3],
     v.foruser1[3],
     v.foruser2[3],
     v.foruser3[3],

     );

     
     })
 

     

    //  以下で関数GetMapを定義（変数がめちゃくちゃ多い 笑）

     function GetMap(a,b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u) {

    const map = new Microsoft.Maps.Map('#myMap', {
    center: new Microsoft.Maps.Location(47.6149, -122.1941), //Location center position
    mapTypeId: Microsoft.Maps.MapTypeId.aerial, //Type: [load, aerial,canvasDark,canvasLight,birdseye,grayscale,streetside]
    zoom: 8  //Zoom:1=zoomOut, 20=zoomUp[ 1~20 ]    
    });

        let center = map.getCenter();


        console.log(b);

        // ★地図上に一つ目のピンを立てる
        let pin = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(a, b),{

        color:'red',
        draggable:false,
        enableHoverStyle:true,
        enableClickedStyle:true,
        visible:true,
        title: c

        })

        map.entities.push(pin);


        // ピンをクリックすると、アーティスト、作品の詳細に飛べるURLがピンで出てくる

         Microsoft.Maps.Events.addHandler(pin, 'dblclick', function (e) {  
    
    
         let infobox = new Microsoft.Maps.Infobox(new Microsoft.Maps.Location(e.location.latitude, e.location.longitude), {

            title: c,

            actions: [{
            label: 'artist',
            eventHandler: function () { //function
                window.open(d);
            }
            }, {
            label: 'work',
            eventHandler: function () { //function
                window.open(f);
            }
            }]

         });

            infobox.setMap(map); //Add infobox to Map


         });








        //  地図帳に2つ目のピンを立てる

         let pin1 = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(g, h),{


            color:'red',
            draggable:false,
            enableHoverStyle:true,
            enableClickedStyle:true,
            visible:true,
            title: i

        })

       
        map.entities.push(pin1);


         // ピンをクリックすると、アーティスト、作品の詳細に飛べるURLがピンで出てくる

        Microsoft.Maps.Events.addHandler(pin1, 'dblclick', function (e) {  
        

        let infobox = new Microsoft.Maps.Infobox(new Microsoft.Maps.Location(e.location.latitude, e.location.longitude), {

        title: i,

        actions: [{
        label: 'artist',
        eventHandler: function () { //function
            window.open(j);
        }
        }, {
        label: 'work',
        eventHandler: function () { //function
            window.open(k);
        }
        }]

        });

        infobox.setMap(map); //Add infobox to Map


        });










        // 地図上に３つ目のピンを立てる
        let pin2 = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(l, m),{

        color:'red',
        draggable:false,
        enableHoverStyle:true,
        enableClickedStyle:true,
        visible:true,
        title: n

        })

        map.entities.push(pin2);



        // ピンをクリックすると、アーティスト、作品の詳細に飛べるURLがピンで出てくる

        Microsoft.Maps.Events.addHandler(pin2, 'dblclick', function (e) {  

            let infobox = new Microsoft.Maps.Infobox(new Microsoft.Maps.Location(e.location.latitude, e.location.longitude), {

            title: n,

            actions: [{
            label: 'artist',
            eventHandler: function () { //function
                window.open(o);
            }
            }, {
            label: 'work',
            eventHandler: function () { //function
                window.open(p);
            }
            }]

            });

            infobox.setMap(map); //Add infobox to Map


            });










        // 以下で４つ目のピンを立てる

        let pin3 = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(q, r),{

        color:'red',
        draggable:false,
        enableHoverStyle:true,
        enableClickedStyle:true,
        visible:true,
        title: s

        })

        map.entities.push(pin3);






        // ピンをクリックすると、アーティスト、作品の詳細に飛べるURLがピンで出てくる

        Microsoft.Maps.Events.addHandler(pin3, 'dblclick', function (e) {  

        let infobox = new Microsoft.Maps.Infobox(new Microsoft.Maps.Location(e.location.latitude, e.location.longitude), {

        
        title: s,

        actions: [{
        label: 'artist',
        eventHandler: function () { //function
            window.open(t);
        }
        }, {
        label: 'work',
        eventHandler: function () { //function
            window.open(u);
        }
        }]

        });

        infobox.setMap(map); //Add infobox to Map


        });




}




</script>



   

  

  







   
</body>

</html>




